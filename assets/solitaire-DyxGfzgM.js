import"./modulepreload-polyfill-B5Qt9EMX.js";console.log("i am here");let l={tableau:[],foundations:[],stock:[],waste:[]};class r{constructor(e,n){this.suit=e,this.value=n,this.faceUp=!1,this.id=`card-${e}-${n}`}flip(){this.faceUp=!this.faceUp}getSuitSymbol(){return{hearts:"♥",diamonds:"♦",clubs:"♣",spades:"♠"}[this.suit]}createCardElement(){const e=document.createElement("div");return e.className=`card ${this.suit}`,e.draggable=!0,e.id=this.id,this.faceUp?e.innerHTML=`
                <div class="cardContent">
                    <div class="card-value top-value">${this.value}</div>
                    <div class="center-suit">${this.getSuitSymbol()}</div>
                    <div class="card-value bottom-value">${this.value}</div>
                </div>
            `:e.classList.add("facedown"),e.addEventListener("dragstart",this.dragStart.bind(this)),e}dragStart(e){const n={id:this.id,suit:this.suit,value:this.value};e.dataTransfer.setData("text/plain",JSON.stringify(n))}}class E{constructor(){this.cards=this.createDeck()}createDeck(){const e=["hearts","diamonds","clubs","spades"],n=["A","2","3","4","5","6","7","8","9","10","J","Q","K"],s=[];for(let o of e)for(let i of n)s.push(new r(o,i));return s}}function b(t){for(let e=t.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}}function w(t){const e=Array(7).fill().map(()=>[]);for(let n=0;n<7;n++)for(let s=n;s<7;s++)e[s].push(t.pop());return e}function g(t){t.forEach(e=>{e.length>0&&e[e.length-1].flip()})}function k(t){t.forEach((e,n)=>{const s=document.getElementById(`tableau-${n}`);s.innerHTML="",e.forEach((o,i)=>{const a=o.createCardElement();a.style.position="absolute",a.style.top=`${i*30}px`,a.style.left="0px",s.appendChild(a)})})}function C(t){t.forEach((e,n)=>{const s=document.getElementById(`foundation-${n}`);s.innerHTML="",e.length>0&&s.appendChild(e[e.length-1].createCardElement())})}function L(t){const e=document.getElementById("stock");e.innerHTML=t.length>0?'<div class="card facedown"></div>':""}function y(t){const e=document.getElementById("waste");e.innerHTML="",t.length>0&&e.appendChild(t[t.length-1].createCardElement())}function c(t){k(t.tableau),C(t.foundations),L(t.stock),y(t.waste)}function m(){const t=new E().cards;b(t);const e=w(t);g(e);const n=t,s=Array(4).fill().map(()=>[]);return{tableau:e,stock:n,foundations:s,waste:[]}}function I(){l=m(),c(l),console.log(l),M(l)}function f(t){t.foundations.every(n=>n.length===13)&&alert("Lo hicimos, adaddadadada")}document.addEventListener("DOMContentLoaded",I);function T(t,e,n){if(e.classList.contains("foundationDeck")){const s=parseInt(e.id.split("-")[1]);return p(t,n.foundations[s])}else if(e.classList.contains("tableau-pile")){const s=parseInt(e.id.split("-")[1]);return d(t,n.tableau[s])}return!1}function S(t,e,n){const s=document.getElementById(t.id);if(!s){console.log("Source element not found");return}const o=s.closest(".tableau-pile, .foundationDeck, #waste");if(!o){console.log("Source pile not found");return}if(o.classList.contains("tableau-pile")){const i=parseInt(o.id.split("-")[1]),a=n.tableau[i].findIndex(v=>v.id===t.id);a!==-1&&n.tableau[i].splice(a,1)}else o.id==="waste"&&n.waste.pop();if(e.classList.contains("foundationDeck")){const i=parseInt(e.id.split("-")[1]),a=new r(t.suit,t.value);a.faceUp=!0,n.foundations[i].push(a)}else if(e.classList.contains("tableau-pile")){const i=parseInt(e.id.split("-")[1]),a=new r(t.suit,t.value);a.faceUp=!0,n.tableau[i].push(a)}if(o.classList.contains("tableau-pile")){const i=parseInt(o.id.split("-")[1]);n.tableau[i].length>0&&n.tableau[i][n.tableau[i].length-1].flip()}c(n),f(n)}function p(t,e){if(e.length===0)return t.value==="A";const n=e[e.length-1],s=["A","2","3","4","5","6","7","8","9","10","J","Q","K"];return t.suit===n.suit&&s.indexOf(t.value)===s.indexOf(n.value)+1}function d(t,e){if(e.length===0)return t.value==="K";const n=e[e.length-1],s=["A","2","3","4","5","6","7","8","9","10","J","Q","K"],o=["hearts","diamonds"],i=["spades","clubs"];return(o.includes(t.suit)&&i.includes(n.suit)||i.includes(t.suit)&&o.includes(n.suit))&&s.indexOf(t.value)===s.indexOf(n.value)-1}function u(t,e,n){const s=t.splice(n);e.push(...s),t.length>0&&!t[t.length-1].faceUp&&t[t.length-1].flip(),c(l)}function D(t){if(t.stock.length>0){const e=t.stock.pop();e.flip(),t.waste.push(e)}else t.waste.length>0&&(t.stock=t.waste.reverse(),t.waste=[],t.stock.forEach(e=>e.flip()));c(t)}function M(t){O(t),U(t),A(t),H(t),x(t),document.getElementById("waste").addEventListener("click",()=>h())}function x(t){document.querySelectorAll(".drop-zone").forEach(n=>{n.addEventListener("dragover",B),n.addEventListener("drop",s=>$(s,t)),console.log(`Drop listener added to: ${n.id}`)})}function B(t){t.preventDefault(),t.currentTarget.classList.add("drag-over"),console.log("Dragover event fired")}function $(t,e){t.preventDefault(),console.log("Drop event fired");const n=JSON.parse(t.dataTransfer.getData("text/plain"));console.log("Card data:",n);const s=document.getElementById(n.id),o=t.target.closest(".tableau-pile, .foundationDeck, #waste");s&&o&&(T(n,o,e)?(S(n,o,e),c(e)):console.log("Invalid move"))}function O(t){t.tableau.forEach((e,n)=>{const s=document.getElementById(`tableau-${n}`);s.addEventListener("click",o=>{const i=o.target.closest(".card");if(i){const a=Array.from(s.children).indexOf(i);J(t,n,a)}})})}function U(t){t.foundations.forEach((e,n)=>{document.getElementById(`foundation-${n}`).addEventListener("click",()=>{K(t,n)})})}function A(t){document.getElementById("stock").addEventListener("click",()=>{D(t)})}function H(t){document.getElementById("waste").addEventListener("click",()=>{t.waste.length>0&&h()})}function J(t,e,n){const s=t.tableau[e],o=s[n];if(!o.faceUp){n===s.length-1&&(o.flip(),c(t));return}if(n===s.length-1){for(let a=0;a<t.foundations.length;a++)if(p(o,t.foundations[a])){u(s,t.foundations[a],n),c(t),f(t);return}}const i=s.slice(n);for(let a=0;a<t.tableau.length;a++)if(a!==e&&d(i[0],t.tableau[a])){F(s,t.tableau[a],n),c(t);return}}function F(t,e,n){const s=t.splice(n);e.push(...s),t.length>0&&!t[t.length-1].faceUp&&t[t.length-1].flip()}function K(t,e){const n=t.foundations[e];if(n&&n.length>0){const s=n[n.length-1];for(let o=0;o<t.tableau.length;o++)if(d(s,t.tableau[o])){u(n,t.tableau[o],n.length-1),c(t);break}}}function h(){if(l.waste.length>0){const t=l.waste[l.waste.length-1];for(let e=0;e<l.foundations.length;e++)if(p(t,l.foundations[e])){u(l.waste,l.foundations[e],l.waste.length-1),c(l),f(l);return}for(let e=0;e<l.tableau.length;e++)if(d(t,l.tableau[e])){u(l.waste,l.tableau[e],l.waste.length-1),c(l);return}}}
